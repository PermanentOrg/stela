archives:
  parameters:
    - name: searchQuery
      in: query
      required: false
      description: Filter archives by name matching this search query. At least one of searchQuery or callerMembershipRole is required.
      schema:
        type: string
    - name: callerMembershipRole
      in: query
      required: false
      description: |
        Filter to archives where the authenticated user has one of the specified archive membership roles.
        Can be repeated to filter by multiple roles (OR logic). Requires authentication.
        At least one of searchQuery or callerMembershipRole is required.
      schema:
        type: array
        items:
          $ref: "../models/archive_membership_role.yaml#/archiveMembershipRole"
      style: form
      explode: true
    - name: pageSize
      in: query
      required: true
      schema:
        type: integer
        minimum: 1
    - name: cursor
      in: query
      required: false
      schema:
        type: string
  get:
    summary: Search and filter archives
    description: |
      Search for archives by name and/or filter by the authenticated user's archive membership role.

      - Unauthenticated requests return only public archives.
      - Admin-authenticated requests return public archives with owner contact information.
      - User-authenticated requests return public archives and archives of which the caller is a member.

      When filtering by callerMembershipRole:
      - Requires authentication (returns 401 if unauthenticated)
      - Returns only archives where the user has one of the specified roles
      - Includes the user's callerMembershipRole for each returned archive
    security:
      - {}
      - bearerHttpAuthentication: []
    tags:
      - archives
    operationId: get-archives
    responses:
      "200":
        description: A list of archives.
        content:
          application/json:
            schema:
              type: object
              properties:
                items:
                  type: array
                  items:
                    $ref: "../models/archive.yaml#/archive"
      "400":
        $ref: "../errors.yaml#/400"
      "401":
        $ref: "../errors.yaml#/401"
      "500":
        $ref: "../errors.yaml#/500"
archives/{id}:
  patch:
    summary: Update an archive
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
    security:
      - bearerHttpAuthentication: []
    tags:
      - archives
    operationId: patch-archives
    requestBody:
      content:
        application/json:
          schema:
            type: object
            properties:
              milestoneSortOrder:
                type: string
                enum:
                  - chronological
                  - reverse_chronological
    responses:
      "200":
        description: The updated archive
        content:
          application/json:
            schema:
              type: object
              properties:
                data:
                  $ref: "../models/archive.yaml#/archive"
      "400":
        $ref: "../errors.yaml#/400"
      "500":
        $ref: "../errors.yaml#/500"
archives-id-folders-shared:
  parameters:
    - name: id
      in: path
      required: true
      schema:
        type: string
  get:
    summary: Get all the top-level shared folders in an archive
    security:
      - bearerHttpAuthentication: []
    tags:
      - folders
    operationId: get-archive-shared-folders
    responses:
      "200":
        description: A list of shared folders
        content:
          application/json:
            schema:
              type: object
              properties:
                items:
                  type: array
                  items:
                    $ref: "../models/folder.yaml#/folder"
      "400":
        $ref: "../errors.yaml#/400"
      "401":
        $ref: "../errors.yaml#/401"
      "403":
        $ref: "../errors.yaml#/403"
      "404":
        $ref: "../errors.yaml#/404"
      "500":
        $ref: "../errors.yaml#/500"
